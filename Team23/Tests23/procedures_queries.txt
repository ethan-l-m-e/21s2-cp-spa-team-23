../../../../Tests23/procedures_source.txt ../../../../Tests23/procedures_queries.txt ../../../tests/out.xml
procedure p;
Select p
proc1, proc2, proc3, proc4
5000
1 - [valid] check calls
call c;
Select c
1, 2, 3
5000
2 - [valid] check procedure modifies x
stmt s;
Select s such that Modifies("proc4", "x")
1, 2, 3, 4, 5, 6
5000
3 - [valid] check procedure Uses x
stmt s;
Select s such that Uses("proc4", "x")
none
5000
4 - [valid] procedure modifies varName ===============================================[Select procedure tests start]
procedure p;
Select p such that Modifies(p, "x")
proc1, proc2, proc3, proc4
5000
5 - [valid] procedure uses varName
procedure p;
Select p such that Uses(p, "x")
proc1, proc2, proc3
5000
6 - [valid] procedure uses wildcard
procedure p;
Select p such that Modifies(p, _)
proc1, proc2, proc3, proc4
5000
7 - [valid] procedure uses wildcard
procedure p;
Select p such that Uses(p, _)
proc1, proc2, proc3
5000
8 - [valid] procedure uses variable
procedure p; variable v;
Select p such that Modifies(p, v)
proc1, proc2, proc3, proc4
5000
9 - [valid] procedure uses variable
procedure p; variable v;
Select p such that Uses(p, v)
proc1, proc2, proc3
5000
10 - [valid] call modifies varName =========================================================[Select call tests start]
call c;
Select c such that Modifies(c, "x")
1, 2, 3
5000
11 - [valid] call uses varName
call c;
Select c such that Uses(c, "x")
1, 3
5000
12 - [valid] call uses wildcard
call c;
Select c such that Modifies(c, _)
1, 2, 3
5000
13 - [valid] call uses wildcard
call c;
Select c such that Uses(c, _)
1, 3
5000
14 - [valid] call uses variable
call c; variable v;
Select c such that Modifies(c, v)
1, 2, 3
5000
15 - [valid] call uses variable
call c; variable v;
Select c such that Uses(c, v)
1, 3
5000
16 - [valid] direct calls ========================================================================[Calls rs tests start]
procedure p;
Select p such that Calls(p, _)
proc1, proc2
5000
17 - [valid] direct calls with procName
procedure p;
Select p such that Calls(p, "proc3")
proc2
5000
18 - [valid] direct calls with procName lhs
procedure p;
Select p such that Calls("proc1", p)
proc2, proc4
5000
19 - [valid] direct calls with two procName
procedure p;
Select p such that Calls("proc1", "proc4")
proc1, proc2, proc3, proc4
5000
20 - [valid] direct calls with two procName but does not call
procedure p;
Select p such that Calls("proc1", "proc3")
none
5000
21 - [valid] calls with no relation wildcards
call c;
Select c such that Calls(_, _)
1, 2, 3
5000
22 - [valid] indirect calls with no relation wildcards
call c;
Select c such that Calls*(_, _)
1, 2, 3
5000
23 - [valid] indirect calls
procedure p;
Select p such that Calls* (p, _)
proc1, proc2
5000
24 - [valid] indirect calls with procName
procedure p;
Select p such that Calls*(p, "proc3")
proc1, proc2
5000
25 - [valid] indirect calls with procName lhs
procedure p;
Select p such that Calls*("proc1", p)
proc2, proc3, proc4
5000
26 - [valid] indirect calls with two procName
procedure p;
Select p such that Calls*("proc1", "proc3")
proc1, proc2, proc3, proc4
27 - [valid] indirect calls with two procName but does not call
procedure p;
Select p such that Calls*( "proc3", "proc4")
none
5000
28 - [not valid] stmt modifies with call on rhs ==================================================[Invalid tests start]
stmt s; call c;
Select s such that Modifies(s, c)
none
5000
29 - [not valid] read modifies with call on rhs
read r; call c;
Select r such that Modifies(r, c)
none
5000
30 - [not valid] stmt uses with call on rhs
stmt s; call c;
Select s such that Uses(s, c)
none
5000
31 - [not valid] stmt uses with call on rhs
print p; call c;
Select p such that Uses(p, c)
none
5000